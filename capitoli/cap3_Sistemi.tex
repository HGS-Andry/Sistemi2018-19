\chapter{Sistemi a tempo continuo}
%TODO immagine e descrizione?

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Proprietà dei sistemi a tempo continuo
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Proprietà dei sistemi a tempo continuo}
\subsection{Linearità}\label{sist_prop_Lin}  
	\[
	\alpha u_1+\beta u_1 \overset{\text{sistema}}{\longmapsto} \alpha v_1+\beta v_2
	\]
	dove $ u_1 \overset{\text{sistema}}{\longmapsto} v_1$ e $u_2\overset{\text{sistema}}{\longmapsto} v_2$
	
\subsection{Tempo invarianza} \label{sist_prop_TIn}
	\[
	u(t-\tau) \overset{\text{sistema}}{\longmapsto} v(t-\tau)
	\]
	
	\begin{definizione}
		I sistemi che soddisfano \ref{sist_prop_Lin} e \ref{sist_prop_TIn} li chiameremo sistemi LTI
	\end{definizione}

 \subsection{Causalità (Sistema non anticipatorio):} \label{sist_prop_cau}
	
	L'effetto non precede la causa (la causa anticipa l'effetto)
	
	\begin{osservazione}
		Ci sarà sempre un istante iniziale $t_0$ a partire da cui studieremo il sistema
		%TODO non sono sicuro
	\end{osservazione}
	\[
		\Leftrightarrow \exists \,t_0 \in \mathbb{R} \quad t.c. \quad u(t)=0 \quad t<t_0
		\Rightarrow v(t)=0 \quad t<t_0
		\quad t_0 =0 \quad \text{per Tempo Invarianza (TI)}
	\]
	%TODO aggiungere disegno?
\subsection{Stabilità BIBO (Bounded Input Bounded Output)}\label{sist_prop_BIBOstab}
	
	Per sistemi causali (da un entrata limitata c'è un' uscita limitata)
	\[
	\begin{split}
		\forall t \in [t_0, + \infty) \subseteq \mathbb{R} \qquad \exists \, M_u >0 \quad t.c. \quad \lvert u(t) \rvert < M_u \\
		\Rightarrow \exists \, M_v > 0 \quad t.c. \quad \forall t \in [t_0, + \infty) \quad t.c. \quad \lvert v(t) \rvert < M_v\\
	\end{split}		
	\]
	%TODO aggiungere disegno
	
\subsection{Stabilità asintotica}
	Se $\exists \, t_0 \quad t.c. \quad u(t)=0, \quad \forall t \ge t_0 \Rightarrow \lim_{t \to +\infty} v(t)=0$\\
	In assenza di sollecitazioni in ingresso l'uscita converge a zero asintoticamente: $\lim_{t \to \infty} v(t)=0$
	%TODO: aggiungere immagini?
	
%TODO esempi di modelli di equaz. differenziali


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Modelli
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	
\section{Modelli}

In generale un modello SISO è descritto da un'equazione differenziale a coefficienti costanti di ordine $n$.
%TODO aggiungiamo di nuovo la formula 1?
\begin{multline}
%\begin{multline}
	a_n \frac{d^{(n)} v(t)}{dt^n} 
		+ a_{n-1} \frac{d^{(n-1)} v(t)}{dt^{n-1}} 
		+ \dots 
		+ a_1 \frac{dv(t)}{dt} 
		+ a_0\,v(t)\\
	= b_m \frac{d^{(m)} u(t)}{dt^m}
		+ b_{m-1} \frac{d^{(m-1)} u(t)}{dt^{m-1}} 
		+ \dots
		+ b_1 \frac{du(t)}{dt} 
		+ b_0\,u(t) \qquad
	a_n, b_m \ne 0	
%\end{multline}
	%TODO sarebbe carino dividerla decentemente	
\tag{2}\label{equation 2}
\end{multline}

\begin{osservazione}
	Nei casi pratici $n \ge m$	
\end{osservazione}

\begin{definizione}
	I sistemi in cui $n \ge m$ si chiamano propri. Se $n > m$ il sistema si chiamerà strettamente proprio.
	%TODO enfatizzare proprio e strettametne proprio
\end{definizione}

\begin{osservazione}
	In generale l'uscita $v(t)$ del sistema (\ref{equation 1})
	non è univoca. Se definiamo $n$ condizioni iniziali all'istante $t_0 = 0^-$ (per l'uscita $v$):
	\begin{equation}
		v(0^-) \,
		,\, \frac{dv(t)}{dt}\bigg\vert_{t=0^-} \,
		,\, \dots\,
		,\, \frac{d^{(n-1)}v(t)}{dt^{n-1}}\bigg\vert_{t=0^-}
		\tag{3}\label{equation 3}
	\end{equation}
	$\Rightarrow$ la soluzione di (\ref{equation 1}) è unica.
\end{osservazione}

La soluzione dell'equazione (\ref{equation 1}) si ottiene come somma di una soluzione che dipende soltanto dalle condizioni iniziali (\ref{equation 3}) chiamato evoluzione libera $v_l(t)$ e da una soluzione che dipende soltanto dall'ingresso $u(t)$ con condizioni iniziali tutte nulle, chiamato evoluzione forzata $v_f(t)$ %TODO sottolineare evoluzione forzata e libera
\[
v(t) = v_l(t) + v_f(t)
\]
L'evoluzione libera si ottiene dall'equazione omogenea associata
\begin{equation}
	a_n \frac{d^{(n)} v(t)}{dt^n} 
		+ a_{n-1} \frac{d^{(n-1)} v(t)}{dt^{n-1}} 
		+ \dots 
		+ a_1 \frac{dv(t)}{dt} 
		+ a_0\,v(t)
	= 0
	\tag{4}\label{equation 4}
\end{equation}
e le condizioni iniziali (\ref{equation 3}).

Associamo a (\ref{equation 4}) l'equazione caratteristica. Otteniamo il polinomio caratteristico: %TODO enfatizza polinomio caratteristico
\begin{equation}
	a_n s^n 
	+ a_{n-1} s^{n-1}
	+ \dots
	+ a_1 s^1
	+ a_0
	\tag{5}\label{equation 5}
\end{equation}

Per il toerema fondamentale dell'algebra, (\ref{equation 5}) ha $r$ radici  distinte $\lambda_1,\lambda_2, \dots, \lambda_r$ di molteplicità $\mu_1, \mu_2, \dots,\mu_r$ dove  $\mu_1 +\mu_2 + \dots + \mu_r = n$
%TODO controlla

La soluzione di (\ref{equation 4}) sarà:
\begin{equation}
	v_l(t)=  \sum_{i=1}^{r}\sum_{l=0}^{\mu_i-1}c_{i,l} \,e^{\lambda_it}\frac{t^l}{l!}
	\tag{6}\label{equation 6}
\end{equation}
I coefficienti $c_{i,l}
	\quad i=\overline{1,r} 
	\quad l=\overline{o,\mu_{i-1}}
	\quad \forall\mu_i \in \{\mu_1,\mu_2,\dots,\mu_r\} $ 
	verranno determinati dalle condizioni iniziali (\ref{equation 3})
	
\begin{osservazione}
	Se $\mu_1 = \mu_2 = \dots = \mu_r = 1$ allora:
	\begin{equation*}
		v_l(t)=  \sum_{i=1}^{n}c_{i} \,e^{\lambda_it}
	\end{equation*}
\end{osservazione}

\begin{definizione}
	$m(t) = e^{\lambda_i t} \frac{t^l}{l!} $ si chiama modo elementare del sistema
	%TODO enfatizzare modo elementare del sistema
\end{definizione}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Stabilità
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Stabilità}
%TODO 
\subsection{Stabilità asintotica}
Si studia la stabilità asintotica di sistemi descritti dall'equazione (\ref{equation 1})

\begin{theorem}
	Il sistema (\ref{equation 1}) è asintoticamente stabile se per ogni scelta delle consizioni iniziali:
	\begin{equation*}
		\lim_{t \to \infty}v_l(t)=0
		\Leftrightarrow\text{tutti i modi elementari } m(t)=e^{\lambda t}\frac{t^l}{l!}\text{ sono convergenti a $0$}
		\Leftrightarrow Re(\lambda_i)<0,\forall i = \overline{1,r}
	\end{equation*}
\end{theorem}
%TODO: Aggiungere esempio filtro RL
%TODO: Aggiungere esempio massa molla smorzatore

%TODO

\subsection{BIBO stabilità}
%TODO


\section{Risposta Libera}
%TODO


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Risposta impulsiva
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Risposta Impulsiva}

\begin{definizione}
	Dato un sistema descritto dall'equazione (\ref{equation 1}), inizialmente a riposo, definiamo la risposta impulsiva e indichiamo con $h(t)$ l'uscita del sistema in corrispondenza dell'impulso unitario $\delta (t)$ in ingresso.
\end{definizione}

\begin{definizione}
	Date due funzioni $v_1(t)$ e $v_2(t) \quad t\in\mathbb{R} $ definiamo il prodotto (o integrale) di convoluzione come:
	\begin{equation*}
		(v_1 * v_2)(t) 
		= \int_{-\infty}^{\infty}v_1(\tau)v_2(\tau - t)\,d\tau 
		= \int_{-\infty}^{\infty}v_1(t - \tau)v_2(\tau )\,d\tau
	\end{equation*}
	
	Proprietà
	\begin{enumerate}
		\item $v_1 * v_2 = v_2 * v_1 $ (commutatività)
		\item $(v_1 * v_2) * v_3  = v_1 * (v_2 * v_3) $ (associatività)
		\item $v_1 * (v_2 + v_3)  = v_1 * v_2 + v_1 * v_3$ (distributività)
	\end{enumerate}

\begin{osservazione}
	$(v *\delta)(t)\overset{def}{=} \int_{-\infty}^{\infty}v(\tau)\delta(t - \tau)\,d\tau = v(t)$ (proprietà di riproducibilità dell'impulso)
\end{osservazione}
\end{definizione}
%TODO: Aggiugnere immagine con sistemi a blocchi? Mi pare una ripetizione
%TODO: non so come definire questa parte se è una dimostrazione o un teorema
Tenendo conto che $h(t)=0$ per $t<0$ (causalità) avremo:
\begin{equation*}
	\int_{-\infty}^{\infty}h(\tau)u(t - \tau)\,d\tau 
	= \int_{-\infty}^{t^+}h(t - \tau)u(\tau)\,d\tau
\end{equation*}
\begin{proof}[Dim]
ponendo:  $t-\tau = s \Rightarrow d\tau = - ds 
\qquad \tau = 0^-  \Rightarrow s = t^+ 
\qquad \tau=\infty \Rightarrow s = -\infty$
\[
%TODO controllare gil estremi dell'integrale
\int_{t^+}^{\infty}h(t-s)u(s)\,-ds 
=-\int_{t^+}^{\infty}h(t-s)u(s)\,ds
=\int_{-\infty}^{t^+}h(t-s)u(s)\,ds
\qedhere
\]
\end{proof}

proprieta:
La risposta in uscita del sistema (\ref{equation 1}), inizialmente a riposo, di risposta impulsiva $h(t)\quad t\in\mathbb{R}$ in corrispondenza a un ingresso $u(t)\quad t\in\mathbb{R}$, se esiste, è data da:
\[
v(t)=(h*u)(t) = \int_{0^-}^{\infty}h(\tau)u(t - \tau)\,d\tau
= \int_{-\infty}^{t^+}h(t - \tau)u(\tau)\,d\tau
\]
in particolare la risposta forzata ad un ingresso $u(t)\quad t\in\mathbb{R} \quad u(t)=0 ,\quad t<0$ è:
%TODO contollare se va bene formulata così
\[
v\!_f(t) =
\int_{0^-}^{t^+}h(t - \tau)u(\tau)\,d\tau 
 \,= 
\int_{0^-}^{t^+}h(\tau)u(t - \tau)\,d\tau 
\]

%TODO anche qui non so cosa sia
sostituisco $\delta (t)$ in (\ref{equation 1}):
\begin{equation}
	a_n \frac{d^{(n)} h(t)}{dt^n}+\dots+a_0\,h(t) = b_m \frac{d^{(n+1)} \delta(t)}{dt^{n+1}}+\dots+b_0\,\delta(t) %TODO n+1 oppure m+1?
	\tag{7}\label{equation 7}
\end{equation}
Studiamo l'evoluzione forzata sull'orizzonte temporale $(0,+\infty)$ (da notare che va da $0$ a $n-1$) %TODO aggiungere disegno?

\begin{multline} %TODO controlla formula, soprattutto t = 0-
	h(0) = \frac{dh(t)}{dt}\bigg\vert_{t=0^-} = \dots %TODO controlla se si parla di tutte o solo delle prime due e dell'ultima
	=\frac{d^{(n-1)}h(t)}{dt^{n-1}}\bigg\vert_{t=0^-}
	= 0,\quad
	\delta(t) = 0 \\
	\overset{\eqref{equation 7}}{\Rightarrow}a_n \frac{d^{(n)} h(t)}{dt^n}+\dots+a_0\,h(t) = 0 
	\qquad\text{per } t>0
	\tag{8}\label{equation 8}
\end{multline}
	
 %TODO controlla formula
\begin{osservazione}
	$\eqref{equation 8} \Rightarrow h (t)$ è una combinazione lineare di tutti i modi elementari ottenuti dalla soluzione dell'equazione caratteristica del sistema (\ref{equation 1}) in cui si aggiunge un termine impulsivo soltanto nei sistemi in cui $n=m$:
	\begin{equation}
		h(t)=0 \text{ per } t<0 \Rightarrow h(t) = h(t)\delta_{-1} (t)
		\Rightarrow h(t)= d_0 \delta(t) + \sum_{i=1}^{r}\sum_{l=0}^{\mu_i-1}d_{i,l} \,e^{\lambda_it}\frac{t^l}{t!}\delta_{-1} (t)
		\tag{9}\label{equation 9}
	\end{equation}
\end{osservazione}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Sistemi LTI generali definiti dalla risposta impulsiva
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Sistemi LTI generali definiti dalla risposta impulsiva}

Possono essere non causali.
Per i sistemi causali abbiamo $h(t) =0, t<0$.
In generale possiamo descrivere un sistema SISO associando ad un ingresso $u(t), t \in \mathbb{R}$ e ad una funzione $h(t), t \in \mathbb{R}$ l'uscita:
\begin{equation}
	v(t)=(h*u)(t) = \int_{-\infty}^{+\infty}h(\tau)u(t-\tau)\,d\tau
	\tag{10}\label{equation 10}
\end{equation}

\begin{osservazione}
	per la proprietà del prodotto di convoluzione: $h(t)=(h*s)(t)$ (la risposta impulsiva) %TODO eh?
\end{osservazione}

Per i sistemi LTI causali:
\[
	v(t)=(h*u)(t) = \int_{-\infty}^{t^+}h(t-\tau)u(\tau)\,d\tau = \int_{0^-}^{+\infty}h(\tau)u(t-\tau)\,d\tau
\]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Stabilità BIBO dei sistemi LTI generali
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Stabilità BIBO dei sistemi LTI generali}
\label{sec:BIBO}

%TODO forse ripetizione
%\emph{Generale} = non più descritti da eq.differenziale.

%\emph{BIBO stabilità} = $\lvert u(t) \rvert < M_u,\quad \forall t \in \mathbb{R} \quad \Rightarrow \quad \exists \, M_v, \quad \lvert v(t) \rvert < M_v, \quad \forall t \in \mathbb{R} $

%TODO come gestiamo le proprietà?
%proprietà:

Un sistema a tempo continuo LTI è BIBO stabile sse:
\[
	\int_{-\infty}^{+\infty}\lvert h(t) \rvert \,dt < +\infty
\]
(La risposta impulsiva è sommabile oppure assolutamente integrabile)

\begin{proof}[Dim]
	\emph{$(\Leftarrow)$}
	\[
		\text{hp:} \quad \int_{-\infty}^{+\infty}\lvert h(t) \rvert \,dt < +\infty \quad \overset{?}{\Rightarrow} \quad \text{BIBO stabile}
	\]	
	dato un ingresso $u(t) \quad t.c.\quad \lvert u(t) \rvert < M_u , \forall t \in \mathbb{R}$ preso $t \in \mathbb{R}$ 
	\[
		\quad v(t)=(h*u)(t) = \int_{-\infty}^{+\infty}h(\tau)u(t-\tau)\,d\tau 
	\]
	%TODO manca qualcosa...
	\[
		\lvert v(t) \rvert 
		= \bigg\lvert \int_{-\infty}^{+\infty}h(\tau)u(t-\tau)\,d\tau \,  \bigg\rvert
		\le \int_{-\infty}^{+\infty} \rvert h(\tau)u(t-\tau) \lvert\,d\tau
		= \int_{-\infty}^{+\infty} \rvert h(\tau) \lvert \, \underbrace{\rvert u(t-\tau) \lvert}_{\le M_u} \,d\tau
		\le \underbrace{\int_{-\infty}^{+\infty} \rvert h(\tau)\lvert\,d\tau}_{\le + \infty}
	\]
	\[
		\text{scegliendo } M_v \coloneqq M_u \int_{-\infty}^{+\infty} \rvert h(\tau)\lvert\,d\tau \in \mathbb{R} \Rightarrow \lvert v(t) \rvert < M_v, \forall t \in \mathbb{R}\Rightarrow \text{BIBO stabile} \qedhere
	\]
\end{proof}

\begin{proof}[Dim]
	\emph{$(\Rightarrow)$}
	\[
		\text{hp: BIBO stabile} \quad \overset{?}{\Rightarrow} \quad \int_{-\infty}^{+\infty}\lvert h(t) \rvert \,dt < +\infty
	\]
	per assurdo supponiamo che :
	\[
		\int_{-\infty}^{+\infty}\lvert h(t) \rvert \,dt = +\infty
	\]
	$\forall u(t)$ con $u(t)<M_u \Rightarrow \exists M_v \quad t.c. \quad v(t) = (h*u)(t), \quad \lvert v(t) \rvert < M_v , \quad \forall t \in \mathbb{R} \quad$scegliamo:
	\[
		u(t) = sgn(h(-t)) = \begin{cases}
			1 &h(-t)>0\\
			0 &h(-t)=0\\
			-1 &h(-t)<0\\
		\end{cases}
	\]
	poniamo $\lvert u(t)\rvert <2,\quad M_u = 2$ (é sempre limitato, ad esempio $<2$). %TODO non sono sicuro della spiegazione
	Quindi:
	\[
		t \in \mathbb{R}\quad v(t) = \int_{-\infty}^{+\infty}h(\tau)u(t-\tau)\,d\tau 
	\]
	Poniamo $t=0$:
	\[
		v(0) = \int_{-\infty}^{+\infty}h(\tau)u(-\tau)\,d\tau 
		= \int_{-\infty}^{+\infty}\underbrace{h(\tau)\, sgn(\tau)}_{\lvert h(\tau)\rvert}\,d\tau %TODO Controlla 
		= \int_{-\infty}^{+\infty}\lvert h(\tau) \rvert \,d\tau = +\infty
	\]
	Ci troviamo in una contraddizione con l'ipotesi.
\end{proof}

\begin{osservazione}\leavevmode
	\begin{enumerate}
		\item Per i sitemi LTI causali BIBO stabilità $\Leftrightarrow \int_{-\infty}^{+\infty}\lvert h(t) \rvert \,dt < +\infty$
		\item Dato (\ref{equation 9}) per il sistema (\ref{equation 1})	$\Rightarrow h(t) $ è sommabile $\Leftrightarrow$ tutti i modi sono cenvergenti (per cui $d_{i,l}\ne0)\Leftrightarrow Re(\lambda_i)<0 \Leftrightarrow $ è BIBO stabile
		\item \{I modi di $h(t)$\} $\subseteq$ \{i modi di $v_l(t)$\} (alcuni modi $d_{i,l}=0$ )
		\item  Stabilità asintotica $\Rightarrow$ BIBO stabilità (il contrario non è valido $\cancel{\Leftarrow}$ )
	\end{enumerate}
\end{osservazione}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Risposta in Frequenza
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Risposta in Frequenza}

Dato un sistema LTI e BIBO dtabile di risposta impulsiva $h(t), t \in \mathbb{R}$ reale a valori reali, mi interessa la risposta al sistema in corrispondenza di ingressi esponenziali con esponente immaginario puro (fasori).

\[ 
	 u_1(t) =Ae^{j(\omega \, t + \phi)}= Ae^{j\phi}e^{j\omega t} \quad \overset{h(t)\text{ BIBO stabile}}{\longmapsto} \quad v_1(t)=?
\]
con $A \in \mathbb{R_+}, \phi$ e $\omega_0 \in \mathbb{R}$. %TODO controlla omega zero?

\[
	v_1(t) = \int_{-\infty}^{+\infty}h(\tau)u_1(t-\tau)\,d\tau
	= \int_{-\infty}^{+\infty}h(\tau)Ae^{j(\omega_0(t-\tau)+\phi)}\,d\tau
	= \underbrace{Ae^{j(\omega_0 t+\phi)}}_{\in \mathbb{C}} \underbrace{\int_{-\infty}^{+\infty}h(\tau)e^{-j\omega_0 \tau}\, d\tau}_{\text{è stabile?}}
\]
Data la definizione di BIBO stabilitá nel paragrafo~\ref{sec:BIBO}:
\[
	\Abs{\int_{-\infty}^{+\infty}h(\tau)e^{-j\omega_0 \tau}\, d\tau} 
	\le \int_{-\infty}^{+\infty}\abs{h(\tau)e^{-j\omega_0 \tau}}\, d\tau
	= \int_{-\infty}^{+\infty}\abs{h(\tau)}\abs{e^{-j\omega_0 \tau}}\, d\tau
	= \int_{-\infty}^{+\infty}\abs{h(\tau)}\, d\tau < +\infty
\]
visto che $\abs{e^{-j\omega_0 \tau}} =1$ perché il modulo di un fasore è sempre $1$

Ora possiamo scrivere:
\[
	H(j\omega_0) = \int_{-\infty}^{+\infty}h(\tau)e^{-j\omega_0 \tau}\, d\tau
\]
\[
	\Rightarrow v_1(t)=H(j\omega_0) A e^{j(\omega_0 t + \phi)}, \quad t \in \mathbb{R}
\]
%TODO unire le due funzioni precedneti?

\begin{definizione}
	Per $ \omega \in \mathbb{R} $ definiamo
	\[
		H(j\omega)= \int_{-\infty}^{+\infty}h(\tau)e^{-j\omega \tau}\, d\tau
	\]
	e la chiamamo la risposta in frequenza del sistema (\ref{equation 10}).
	$ \forall\omega\in\mathbb{R} \mapsto H(j\omega)\in \mathbb{C} \Rightarrow$ esistono due funzioni: $ A(\omega) $ (modulo, ampiezza), $ \Phi(\omega) $ (fase) tali che:
	\begin{gather*}
		A(\omega)\coloneqq\abs{H(j\omega)}=\Abs{\int_{-\infty}^{+\infty}h(\tau)e^{-j\omega \tau}\, d\tau}\\
		\Phi(\omega) \coloneqq \angle H(j\omega)=arg(H(j\omega))=arg(\int_{-\infty}^{+\infty}h(\tau)e^{-j\omega \tau}\, d\tau)
	\end{gather*}
\end{definizione}

%TODO fa parte della definizione?
\[
	\Rightarrow v_1(t) =(A(\omega)A)e^{j(\omega_0 t+\phi+\Phi(\omega_0))} , \quad t \in \mathbb{R}
\]
con $ u_2(t)= A e^{j(\omega_0 t + \phi)}$:
\[
	v_2(t) =h(-j\omega_0)Ae^{-j(\omega_0 t+\phi)}=A(-\omega_0)Ae^{j(\omega_0 t+\phi+\Phi(-\omega_0))} %TODO contorolla formula	
\]
\[
	H(-j\omega_0)= \int_{-\infty}^{+\infty}\underbrace{h(\tau)}_{\in\mathbb{R}}e^{j\omega \tau}\, d\tau
	= \int_{-\infty}^{+\infty}\overline{h(\tau)e^{-j\omega \tau}}\, d\tau
	= \overline{\int_{-\infty}^{+\infty}h(\tau)e^{-j\omega \tau}\, d\tau}
	= \overline{H(j\omega_0)}
\]

$ \Rightarrow A(j\omega) =A(-j\omega)$ (pari) stessa ampiezza tra complesso e il suo coniugato

$ \Rightarrow \Phi(j\omega) =-\Phi(-j\omega)$ (dispari) fase opposta tra complesso e il suo coniugato

Supponiamo un ingresso $ u(t)=A cos(\omega_0 t+\phi), \quad t \in \mathbb{R},\quad A>0, \quad \omega_0 \text{ e } \phi \in \mathbb{R} $ con formula di Eulero: %TODO aggiungere formula di Eulero?

\begin{equation*}
	u(t)=\frac{A}{2}e^{j(\omega_0 t + \phi)}+\frac{A}{2}e^{-j(\omega_0 t + \phi)} 
		= \frac{u_1(t)+ u_2(t)}{2}
\end{equation*}
\begin{equation*}
	\Rightarrow v(t)=
		\frac{v_1(t)+ v_2(t)}{2}
		= \frac{A e^{j(\omega_0 t + \phi) H(j\omega_0)}+ A e^{-j(\omega_0 t + \phi) H(-j\omega_0)}}{2}
\end{equation*}
		essendo complesso coniugato:
\begin{equation*}
		= \frac{A e^{j(\omega_0 t + \phi)} A(\omega_0) e^{j\Phi(\omega_0)} + A e^{-j(\omega_0 t + \phi)} A(\omega_0) e^{-j\Phi(\omega_0)}}{2}\\ %TODO controlla segni j e -j
\end{equation*}
Applicando la formula di Eulero al contrario:
\begin{equation*}
=A\,A(\omega_0)cos(\omega_0 t+\phi+\Phi(\omega_0))
\end{equation*}

La risposta di un sistema LTI reale ($ H(t) $ reale) e BIBO stabile a un segnale sinusoidale di frequenza $ \omega_0 $ è ancora un segnale dellla stessa frequenza e ampiezza data dal prodotto dell'ingfresso A e il modulo della risposta in frequenza calcolato alla frequenza  $ \omega_0 $ e la fase è data dalla somma della fase iniziale $ \phi $ sommata alla fase della risposta in frequenza alla frequenza  $ \omega_0 $
\begin{equation*}
	\begin{split}
	\text{Ampiezza}\quad & A \abs{H(j\omega)}=A\,A(\omega_0)\\	
	\text{Fase}\quad & \angle H(j\omega) = \phi + \Phi(\omega_0)\\
\end{split}
\end{equation*}

Per il sistema (\ref{equation 1}): 
\[
	u(t)= e^{j\omega t}
	\Rightarrow v(t) = e^{j\omega t} H(j\omega)
\]
dove  $ H(j\omega) $ è la risposta in frequenza. Ricordiamo che:
\[
	\frac{d^{(i)}e^{j\omega t}}{dt^i} = (j\omega)^i e^{j\omega t}
\]
inseriamo in (\ref{equation 1}): 
\[
	\sum_{i=0}^{n}a_i\, H(j\omega)(j\omega)^i \cancel{e^{j\omega t}}
	= \sum_{i=0}^{m}b_i \, (j\omega)^i \cancel{e^{j\omega t}}
\]
\[
	\Rightarrow H(j\omega) = \frac{\sum_{i=0}^{m}b_i \, (j\omega)^i}{\sum_{i=0}^{n}a_i\, (j\omega)^i}
\]

